import{r as b,u as H,a as V,j as e,A as c,h as j,s as Y,c as A}from"./app-Crtfxy3G.js";import M from"./first-form-section-eQuZ1oxV.js";import U from"./second-form-section-DH7Qw3cb.js";import{c as q}from"./booking-info-thunk-vgSPSmyk.js";import{F as G}from"./CheckIcon-B2c6AfhW.js";import"./index.esm-CxMHlQUG.js";import"./dayjs.min-CqqUPBIl.js";import"./booking-guest-component-BUZRva78.js";import"./popover-QBS74fUn.js";import"./use-root-containers-IjyDVz-S.js";import"./keyboard-Dey9FxkV.js";import"./use-resolve-button-type-q38L-1xb.js";import"./booking-cart-component-EFJh_gQK.js";import"./index-B-mT_pKO.js";import"./dialog-B4ZLZg3O.js";import"./use-disposables-BVqu0gQI.js";import"./ChevronRightIcon-B0zYd0v9.js";import"./TrashIcon-DarpGftQ.js";import"./booking-info-service-bE9Oe7-K.js";function pe(){const N=window.location.pathname.split("/")[3],[a,O]=b.useState(N?2:1),{selected:l,customer:s,search:n}=H(t=>t.app),[m,d]=b.useState(!1),i=[{id:"01",name:"Booking Order",description:"Completed"},{id:"02",name:"Confirm Booking",description:"Current"}],u=new URLSearchParams(window.location.search),y=u.get("start"),w=u.get("end"),v=V();function o(...t){return t.filter(Boolean).join(" ")}const S=i.map((t,r)=>({...t,status:r+1<a?"complete":r+1===a?"current":"upcoming"})),k=()=>{c.visit(`/admin/booking/checkout?start=${n.start}&end=${n.end}&adults=${n.adults}&children=${n.children}`)},C=()=>{c.visit(`/admin/booking?start=${n.start}&end=${n.end}&adults=${n.adults}&children=${n.children}`)},_=()=>{switch(a){case 1:return e.jsx(M,{});case 2:return e.jsx(U,{});default:return null}};function F(t,r){const E=new Date(t),x=(new Date(r)-E)/(1e3*60*60*24);return x==0?1:x}const p=F(n.start,n.end),h=l.reduce((t,r)=>t+Number(r.rate)*p,0),$=s.adults,L=s.children,P=parseInt(h)+s.children+s.adults,R=(parseInt(h)+s.children+s.adults)/2;console.log("down_payment",l);async function D(t){d(!0);try{const r=j().format("MDDYYYYHHmmss");await Y.dispatch(q({...s,selected:l,reference_id:r,submitted_date:j().format("LLL"),start:y,end:w,adults:$,children:L,total:P,initial:R,status:"pending",processed_by:"admin",gap:p})),d(!1),v(A([])),c.visit("/admin/reservation")}catch{d(!1)}}function z(t){return/^09\d{9}$/.test(t)}function B(t){return/\S+@\S+\.\S+/.test(t)}function f(t){return t==null||t==null||t==""}function g(t){if(l.length==0||m||a==3)return!0;if(l.length!==0&&a==2)if(B(s==null?void 0:s.email))if(z(s.mobile)){if(f(s==null?void 0:s.fname)||f(s==null?void 0:s.lname))return!0}else return!0;else return!0;else return!1}return e.jsx("div",{children:e.jsxs("div",{className:"lg:border-b lg:border-t lg:border-gray-200 mt-5 mb-5",children:[e.jsx("nav",{"aria-label":"Progress",className:"",children:e.jsx("ol",{role:"list",className:"overflow-hidden rounded-md lg:flex lg:rounded-none lg:border-l lg:border-r lg:border-b lg:border-gray-200",children:S.map((t,r)=>e.jsxs("li",{className:"relative overflow-hidden lg:flex-1",children:[r>0&&e.jsx("div",{"aria-hidden":"true",className:"absolute inset-0 left-0 top-0 hidden w-3 lg:block",children:e.jsx("svg",{fill:"none",viewBox:"0 0 12 82",preserveAspectRatio:"none",className:"size-full text-gray-300",children:e.jsx("path",{d:"M0.5 0V31L10.5 41L0.5 51V82",stroke:"currentColor",vectorEffect:"non-scaling-stroke"})})}),e.jsx("div",{className:o(r===0?"rounded-t-md border-b-0":"",r===i.length-1?"rounded-b-md border-t-0":"","overflow-hidden border  border-gray-200 lg:border-0"),children:e.jsx("button",{className:"group w-full text-left:",children:t.status==="complete"?e.jsxs(e.Fragment,{children:[e.jsx("span",{"aria-hidden":"true",className:"absolute left-0 top-0 h-full w-1 bg-transparent group-hover:bg-gray-200 lg:bottom-0 lg:top-auto lg:h-1 lg:w-full"}),e.jsxs("span",{className:o(r!==0?"lg:pl-9":"","flex items-start px-6 py-5 text-sm font-medium"),children:[e.jsx("span",{className:"shrink-0",children:e.jsx("span",{className:"flex size-10 items-center justify-center rounded-full bg-cyan-600",children:e.jsx(G,{"aria-hidden":"true",className:"size-6 text-white"})})}),e.jsxs("span",{className:"ml-4 mt-0.5 flex min-w-0 flex-col",children:[e.jsx("span",{className:"text-sm font-medium",children:t.name}),e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Completed"})]})]})]}):t.status==="current"?e.jsxs(e.Fragment,{children:[e.jsx("span",{"aria-hidden":"true",className:"absolute left-0 top-0 h-full w-1 bg-cyan-600 lg:bottom-0 lg:top-auto lg:h-1 lg:w-full"}),e.jsxs("span",{className:o(r!==0?"lg:pl-9":"","flex items-start px-6 py-5 text-sm font-medium"),children:[e.jsx("span",{className:"shrink-0",children:e.jsx("span",{className:"flex size-10 items-center justify-center rounded-full border-2 border-cyan-600",children:e.jsx("span",{className:"text-cyan-600",children:t.id})})}),e.jsxs("span",{className:"ml-4 mt-0.5 flex min-w-0 flex-col",children:[e.jsx("span",{className:"text-sm font-medium text-cyan-600",children:t.name}),e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Current"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{"aria-hidden":"true",className:"absolute left-0 top-0 h-full w-1 bg-transparent group-hover:bg-gray-200 lg:bottom-0 lg:top-auto lg:h-1 lg:w-full"}),e.jsxs("span",{className:o(r!==0?"lg:pl-9":"","flex items-start px-6 py-5 text-sm font-medium"),children:[e.jsx("span",{className:"shrink-0",children:e.jsx("span",{className:"flex size-10 items-center justify-center rounded-full border-2 border-gray-300",children:e.jsx("span",{className:"text-gray-500",children:t.id})})}),e.jsxs("span",{className:"ml-4 mt-0.5 flex min-w-0 flex-col",children:[e.jsx("span",{className:"text-sm font-medium text-gray-500",children:t.name}),e.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Upcoming"})]})]})]})})})]},t.id))})}),e.jsx("div",{className:"mb-8 mt-4 p-4 rounded-lg shadow-md",children:_()}),e.jsxs("div",{className:"fixed bottom-0 mt-4 flex items-center justify-between w-[75vw] p-3",children:[e.jsx("button",{onClick:C,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",disabled:a===1,children:"Previous"}),e.jsx("button",{onClick:a===i.length?()=>D():k,disabled:g(),className:`px-6 py-2 text-white ${g()?"bg-[rgba(45,55,72,0.6)] text-white":"bg-cyan-600 hover:bg-cyan-700 text-white"}}  rounded-md `,children:m?e.jsx(e.Fragment,{children:"Loading..."}):a===i.length?"Place Booking Request":"Proceed to Checkout"})]})]})})}export{pe as default};
