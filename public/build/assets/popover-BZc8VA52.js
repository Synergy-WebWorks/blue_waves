import{r as u,a as h}from"./app-Rypbiuan.js";import{e as me,N as Pe,E as be,n as pe,u as ee,a as te,y as Se,s as R}from"./use-root-containers-C_uCY19d.js";import{O as Q,U as W,y as K,T as ye,n as re,q as oe,s as ie,b as E,j as Ee,c as ge,u as A,d as U,C as j,I as q,e as ce,w as $e,l as Ie,f as L,M as _,x as Te,z as he,k as G,r as de,A as xe,N as ne}from"./keyboard-DakWNHAS.js";import{T as Me}from"./use-resolve-button-type-DYVP3iIQ.js";var we=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(we||{}),Ce=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(Ce||{});let Oe={0:e=>{let o={...e,popoverState:A(e.popoverState,{0:1,1:0})};return o.popoverState===0&&(o.__demoMode=!1),o},1(e){return e.popoverState===1?e:{...e,popoverState:1}},2(e,o){return e.button===o.button?e:{...e,button:o.button}},3(e,o){return e.buttonId===o.buttonId?e:{...e,buttonId:o.buttonId}},4(e,o){return e.panel===o.panel?e:{...e,panel:o.panel}},5(e,o){return e.panelId===o.panelId?e:{...e,panelId:o.panelId}}},le=u.createContext(null);le.displayName="PopoverContext";function X(e){let o=u.useContext(le);if(o===null){let v=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(v,X),v}return o}let ue=u.createContext(null);ue.displayName="PopoverAPIContext";function ae(e){let o=u.useContext(ue);if(o===null){let v=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(v,ae),v}return o}let se=u.createContext(null);se.displayName="PopoverGroupContext";function fe(){return u.useContext(se)}let Z=u.createContext(null);Z.displayName="PopoverPanelContext";function ke(){return u.useContext(Z)}function Fe(e,o){return A(o.type,Oe,e,o)}let Be="div";function Ne(e,o){var v;let{__demoMode:g=!1,...x}=e,l=u.useRef(null),t=K(o,ye(a=>{l.current=a})),m=u.useRef([]),P=u.useReducer(Fe,{__demoMode:g,popoverState:g?0:1,buttons:m,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:u.createRef(),afterPanelSentinel:u.createRef()}),[{popoverState:b,button:i,buttonId:$,panel:r,panelId:N,beforePanelSentinel:w,afterPanelSentinel:S},s]=P,d=re((v=l.current)!=null?v:i),M=u.useMemo(()=>{if(!i||!r)return!1;for(let J of document.querySelectorAll("body > *"))if(Number(J==null?void 0:J.contains(i))^Number(J==null?void 0:J.contains(r)))return!0;let a=oe(),C=a.indexOf(i),V=(C+a.length-1)%a.length,H=(C+1)%a.length,Y=a[V],ve=a[H];return!r.contains(Y)&&!r.contains(ve)},[i,r]),O=ie($),F=ie(N),B=u.useMemo(()=>({buttonId:O,panelId:F,close:()=>s({type:1})}),[O,F,s]),k=fe(),D=k==null?void 0:k.registerPopover,p=E(()=>{var a;return(a=k==null?void 0:k.isFocusWithinPopoverGroup())!=null?a:(d==null?void 0:d.activeElement)&&((i==null?void 0:i.contains(d.activeElement))||(r==null?void 0:r.contains(d.activeElement)))});u.useEffect(()=>D==null?void 0:D(B),[D,B]);let[I,f]=me(),n=Pe({mainTreeNodeRef:k==null?void 0:k.mainTreeNodeRef,portals:I,defaultContainers:[i,r]});be(d==null?void 0:d.defaultView,"focus",a=>{var C,V,H,Y;a.target!==window&&a.target instanceof HTMLElement&&b===0&&(p()||i&&r&&(n.contains(a.target)||(V=(C=w.current)==null?void 0:C.contains)!=null&&V.call(C,a.target)||(Y=(H=S.current)==null?void 0:H.contains)!=null&&Y.call(H,a.target)||s({type:1})))},!0),Ee(n.resolveContainers,(a,C)=>{s({type:1}),Te(C,he.Loose)||(a.preventDefault(),i==null||i.focus())},b===0);let c=E(a=>{s({type:1});let C=a?a instanceof HTMLElement?a:"current"in a&&a.current instanceof HTMLElement?a.current:i:i;C==null||C.focus()}),T=u.useMemo(()=>({close:c,isPortalled:M}),[c,M]),y=u.useMemo(()=>({open:b===0,close:c}),[b,c]),z={ref:t};return h.createElement(Z.Provider,{value:null},h.createElement(le.Provider,{value:P},h.createElement(ue.Provider,{value:T},h.createElement(ge,{value:A(b,{0:U.Open,1:U.Closed})},h.createElement(f,null,j({ourProps:z,theirProps:x,slot:y,defaultTag:Be,name:"Popover"}),h.createElement(n.MainTreeNode,null))))))}let De="button";function Re(e,o){let v=q(),{id:g=`headlessui-popover-button-${v}`,...x}=e,[l,t]=X("Popover.Button"),{isPortalled:m}=ae("Popover.Button"),P=u.useRef(null),b=`headlessui-focus-sentinel-${q()}`,i=fe(),$=i==null?void 0:i.closeOthers,r=ke()!==null;u.useEffect(()=>{if(!r)return t({type:3,buttonId:g}),()=>{t({type:3,buttonId:null})}},[r,g,t]);let[N]=u.useState(()=>Symbol()),w=K(P,o,r?null:n=>{if(n)l.buttons.current.push(N);else{let c=l.buttons.current.indexOf(N);c!==-1&&l.buttons.current.splice(c,1)}l.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),n&&t({type:2,button:n})}),S=K(P,o),s=re(P),d=E(n=>{var c,T,y;if(r){if(l.popoverState===1)return;switch(n.key){case G.Space:case G.Enter:n.preventDefault(),(T=(c=n.target).click)==null||T.call(c),t({type:1}),(y=l.button)==null||y.focus();break}}else switch(n.key){case G.Space:case G.Enter:n.preventDefault(),n.stopPropagation(),l.popoverState===1&&($==null||$(l.buttonId)),t({type:0});break;case G.Escape:if(l.popoverState!==0)return $==null?void 0:$(l.buttonId);if(!P.current||s!=null&&s.activeElement&&!P.current.contains(s.activeElement))return;n.preventDefault(),n.stopPropagation(),t({type:1});break}}),M=E(n=>{r||n.key===G.Space&&n.preventDefault()}),O=E(n=>{var c,T;de(n.currentTarget)||e.disabled||(r?(t({type:1}),(c=l.button)==null||c.focus()):(n.preventDefault(),n.stopPropagation(),l.popoverState===1&&($==null||$(l.buttonId)),t({type:0}),(T=l.button)==null||T.focus()))}),F=E(n=>{n.preventDefault(),n.stopPropagation()}),B=l.popoverState===0,k=u.useMemo(()=>({open:B}),[B]),D=Me(e,P),p=r?{ref:S,type:D,onKeyDown:d,onClick:O}:{ref:w,id:l.buttonId,type:D,"aria-expanded":l.popoverState===0,"aria-controls":l.panel?l.panelId:void 0,onKeyDown:d,onKeyUp:M,onClick:O,onMouseDown:F},I=pe(),f=E(()=>{let n=l.panel;if(!n)return;function c(){A(I.current,{[R.Forwards]:()=>L(n,_.First),[R.Backwards]:()=>L(n,_.Last)})===ne.Error&&L(oe().filter(T=>T.dataset.headlessuiFocusGuard!=="true"),A(I.current,{[R.Forwards]:_.Next,[R.Backwards]:_.Previous}),{relativeTo:l.button})}c()});return h.createElement(h.Fragment,null,j({ourProps:p,theirProps:x,slot:k,defaultTag:De,name:"Popover.Button"}),B&&!r&&m&&h.createElement(ee,{id:b,features:te.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:f}))}let _e="div",Ge=Q.RenderStrategy|Q.Static;function Le(e,o){let v=q(),{id:g=`headlessui-popover-overlay-${v}`,...x}=e,[{popoverState:l},t]=X("Popover.Overlay"),m=K(o),P=ce(),b=P!==null?(P&U.Open)===U.Open:l===0,i=E(r=>{if(de(r.currentTarget))return r.preventDefault();t({type:1})}),$=u.useMemo(()=>({open:l===0}),[l]);return j({ourProps:{ref:m,id:g,"aria-hidden":!0,onClick:i},theirProps:x,slot:$,defaultTag:_e,features:Ge,visible:b,name:"Popover.Overlay"})}let Ae="div",qe=Q.RenderStrategy|Q.Static;function Ke(e,o){let v=q(),{id:g=`headlessui-popover-panel-${v}`,focus:x=!1,...l}=e,[t,m]=X("Popover.Panel"),{close:P,isPortalled:b}=ae("Popover.Panel"),i=`headlessui-focus-sentinel-before-${q()}`,$=`headlessui-focus-sentinel-after-${q()}`,r=u.useRef(null),N=K(r,o,p=>{m({type:4,panel:p})}),w=re(r),S=$e();Ie(()=>(m({type:5,panelId:g}),()=>{m({type:5,panelId:null})}),[g,m]);let s=ce(),d=s!==null?(s&U.Open)===U.Open:t.popoverState===0,M=E(p=>{var I;switch(p.key){case G.Escape:if(t.popoverState!==0||!r.current||w!=null&&w.activeElement&&!r.current.contains(w.activeElement))return;p.preventDefault(),p.stopPropagation(),m({type:1}),(I=t.button)==null||I.focus();break}});u.useEffect(()=>{var p;e.static||t.popoverState===1&&((p=e.unmount)==null||p)&&m({type:4,panel:null})},[t.popoverState,e.unmount,e.static,m]),u.useEffect(()=>{if(t.__demoMode||!x||t.popoverState!==0||!r.current)return;let p=w==null?void 0:w.activeElement;r.current.contains(p)||L(r.current,_.First)},[t.__demoMode,x,r,t.popoverState]);let O=u.useMemo(()=>({open:t.popoverState===0,close:P}),[t,P]),F={ref:N,id:g,onKeyDown:M,onBlur:x&&t.popoverState===0?p=>{var I,f,n,c,T;let y=p.relatedTarget;y&&r.current&&((I=r.current)!=null&&I.contains(y)||(m({type:1}),((n=(f=t.beforePanelSentinel.current)==null?void 0:f.contains)!=null&&n.call(f,y)||(T=(c=t.afterPanelSentinel.current)==null?void 0:c.contains)!=null&&T.call(c,y))&&y.focus({preventScroll:!0})))}:void 0,tabIndex:-1},B=pe(),k=E(()=>{let p=r.current;if(!p)return;function I(){A(B.current,{[R.Forwards]:()=>{var f;L(p,_.First)===ne.Error&&((f=t.afterPanelSentinel.current)==null||f.focus())},[R.Backwards]:()=>{var f;(f=t.button)==null||f.focus({preventScroll:!0})}})}I()}),D=E(()=>{let p=r.current;if(!p)return;function I(){A(B.current,{[R.Forwards]:()=>{var f;if(!t.button)return;let n=oe(),c=n.indexOf(t.button),T=n.slice(0,c+1),y=[...n.slice(c+1),...T];for(let z of y.slice())if(z.dataset.headlessuiFocusGuard==="true"||(f=t.panel)!=null&&f.contains(z)){let a=y.indexOf(z);a!==-1&&y.splice(a,1)}L(y,_.First,{sorted:!1})},[R.Backwards]:()=>{var f;L(p,_.Previous)===ne.Error&&((f=t.button)==null||f.focus())}})}I()});return h.createElement(Z.Provider,{value:g},d&&b&&h.createElement(ee,{id:i,ref:t.beforePanelSentinel,features:te.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:k}),j({mergeRefs:S,ourProps:F,theirProps:l,slot:O,defaultTag:Ae,features:qe,visible:d,name:"Popover.Panel"}),d&&b&&h.createElement(ee,{id:$,ref:t.afterPanelSentinel,features:te.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:D}))}let Ue="div";function ze(e,o){let v=u.useRef(null),g=K(v,o),[x,l]=u.useState([]),t=Se(),m=E(S=>{l(s=>{let d=s.indexOf(S);if(d!==-1){let M=s.slice();return M.splice(d,1),M}return s})}),P=E(S=>(l(s=>[...s,S]),()=>m(S))),b=E(()=>{var S;let s=xe(v);if(!s)return!1;let d=s.activeElement;return(S=v.current)!=null&&S.contains(d)?!0:x.some(M=>{var O,F;return((O=s.getElementById(M.buttonId.current))==null?void 0:O.contains(d))||((F=s.getElementById(M.panelId.current))==null?void 0:F.contains(d))})}),i=E(S=>{for(let s of x)s.buttonId.current!==S&&s.close()}),$=u.useMemo(()=>({registerPopover:P,unregisterPopover:m,isFocusWithinPopoverGroup:b,closeOthers:i,mainTreeNodeRef:t.mainTreeNodeRef}),[P,m,b,i,t.mainTreeNodeRef]),r=u.useMemo(()=>({}),[]),N=e,w={ref:g};return h.createElement(se.Provider,{value:$},j({ourProps:w,theirProps:N,slot:r,defaultTag:Ue,name:"Popover.Group"}),h.createElement(t.MainTreeNode,null))}let He=W(Ne),We=W(Re),je=W(Le),Ve=W(Ke),Ye=W(ze),et=Object.assign(He,{Button:We,Overlay:je,Panel:Ve,Group:Ye});export{et as C};
