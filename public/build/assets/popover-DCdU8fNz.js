import{r as a,R as h}from"./app-CJ70CWqZ.js";import{y as me,n as ce,u as ee,a as te,s as D,e as Pe,N as be,E as Se}from"./use-root-containers-DvTkKYrs.js";import{U as W,y as K,c as E,C as j,I as q,n as re,q as ye,l as Ee,b as pe,d as U,f as L,M as _,k as G,r as de,u as A,N as ne,w as oe,O as Q,x as ge,T as $e,s as ie,j as Ie,z as Te,A as he,e as xe}from"./keyboard-DmuxVYrN.js";import{T as Me}from"./use-resolve-button-type-B8jmY8Ws.js";var we=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(we||{}),Ce=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(Ce||{});let Oe={0:e=>{let o={...e,popoverState:A(e.popoverState,{0:1,1:0})};return o.popoverState===0&&(o.__demoMode=!1),o},1(e){return e.popoverState===1?e:{...e,popoverState:1}},2(e,o){return e.button===o.button?e:{...e,button:o.button}},3(e,o){return e.buttonId===o.buttonId?e:{...e,buttonId:o.buttonId}},4(e,o){return e.panel===o.panel?e:{...e,panel:o.panel}},5(e,o){return e.panelId===o.panelId?e:{...e,panelId:o.panelId}}},le=a.createContext(null);le.displayName="PopoverContext";function X(e){let o=a.useContext(le);if(o===null){let v=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(v,X),v}return o}let ae=a.createContext(null);ae.displayName="PopoverAPIContext";function ue(e){let o=a.useContext(ae);if(o===null){let v=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(v,ue),v}return o}let se=a.createContext(null);se.displayName="PopoverGroupContext";function fe(){return a.useContext(se)}let Z=a.createContext(null);Z.displayName="PopoverPanelContext";function ke(){return a.useContext(Z)}function Fe(e,o){return A(o.type,Oe,e,o)}let Be="div";function Ne(e,o){var v;let{__demoMode:g=!1,...x}=e,l=a.useRef(null),t=K(o,$e(u=>{l.current=u})),m=a.useRef([]),P=a.useReducer(Fe,{__demoMode:g,popoverState:g?0:1,buttons:m,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:a.createRef(),afterPanelSentinel:a.createRef()}),[{popoverState:b,button:i,buttonId:$,panel:r,panelId:N,beforePanelSentinel:w,afterPanelSentinel:S},s]=P,d=re((v=l.current)!=null?v:i),M=a.useMemo(()=>{if(!i||!r)return!1;for(let J of document.querySelectorAll("body > *"))if(Number(J==null?void 0:J.contains(i))^Number(J==null?void 0:J.contains(r)))return!0;let u=oe(),C=u.indexOf(i),V=(C+u.length-1)%u.length,H=(C+1)%u.length,Y=u[V],ve=u[H];return!r.contains(Y)&&!r.contains(ve)},[i,r]),O=ie($),F=ie(N),B=a.useMemo(()=>({buttonId:O,panelId:F,close:()=>s({type:1})}),[O,F,s]),k=fe(),R=k==null?void 0:k.registerPopover,c=E(()=>{var u;return(u=k==null?void 0:k.isFocusWithinPopoverGroup())!=null?u:(d==null?void 0:d.activeElement)&&((i==null?void 0:i.contains(d.activeElement))||(r==null?void 0:r.contains(d.activeElement)))});a.useEffect(()=>R==null?void 0:R(B),[R,B]);let[I,f]=Pe(),n=be({mainTreeNodeRef:k==null?void 0:k.mainTreeNodeRef,portals:I,defaultContainers:[i,r]});Se(d==null?void 0:d.defaultView,"focus",u=>{var C,V,H,Y;u.target!==window&&u.target instanceof HTMLElement&&b===0&&(c()||i&&r&&(n.contains(u.target)||(V=(C=w.current)==null?void 0:C.contains)!=null&&V.call(C,u.target)||(Y=(H=S.current)==null?void 0:H.contains)!=null&&Y.call(H,u.target)||s({type:1})))},!0),Ie(n.resolveContainers,(u,C)=>{s({type:1}),Te(C,he.Loose)||(u.preventDefault(),i==null||i.focus())},b===0);let p=E(u=>{s({type:1});let C=u?u instanceof HTMLElement?u:"current"in u&&u.current instanceof HTMLElement?u.current:i:i;C==null||C.focus()}),T=a.useMemo(()=>({close:p,isPortalled:M}),[p,M]),y=a.useMemo(()=>({open:b===0,close:p}),[b,p]),z={ref:t};return h.createElement(Z.Provider,{value:null},h.createElement(le.Provider,{value:P},h.createElement(ae.Provider,{value:T},h.createElement(xe,{value:A(b,{0:U.Open,1:U.Closed})},h.createElement(f,null,j({ourProps:z,theirProps:x,slot:y,defaultTag:Be,name:"Popover"}),h.createElement(n.MainTreeNode,null))))))}let Re="button";function De(e,o){let v=q(),{id:g=`headlessui-popover-button-${v}`,...x}=e,[l,t]=X("Popover.Button"),{isPortalled:m}=ue("Popover.Button"),P=a.useRef(null),b=`headlessui-focus-sentinel-${q()}`,i=fe(),$=i==null?void 0:i.closeOthers,r=ke()!==null;a.useEffect(()=>{if(!r)return t({type:3,buttonId:g}),()=>{t({type:3,buttonId:null})}},[r,g,t]);let[N]=a.useState(()=>Symbol()),w=K(P,o,r?null:n=>{if(n)l.buttons.current.push(N);else{let p=l.buttons.current.indexOf(N);p!==-1&&l.buttons.current.splice(p,1)}l.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),n&&t({type:2,button:n})}),S=K(P,o),s=re(P),d=E(n=>{var p,T,y;if(r){if(l.popoverState===1)return;switch(n.key){case G.Space:case G.Enter:n.preventDefault(),(T=(p=n.target).click)==null||T.call(p),t({type:1}),(y=l.button)==null||y.focus();break}}else switch(n.key){case G.Space:case G.Enter:n.preventDefault(),n.stopPropagation(),l.popoverState===1&&($==null||$(l.buttonId)),t({type:0});break;case G.Escape:if(l.popoverState!==0)return $==null?void 0:$(l.buttonId);if(!P.current||s!=null&&s.activeElement&&!P.current.contains(s.activeElement))return;n.preventDefault(),n.stopPropagation(),t({type:1});break}}),M=E(n=>{r||n.key===G.Space&&n.preventDefault()}),O=E(n=>{var p,T;de(n.currentTarget)||e.disabled||(r?(t({type:1}),(p=l.button)==null||p.focus()):(n.preventDefault(),n.stopPropagation(),l.popoverState===1&&($==null||$(l.buttonId)),t({type:0}),(T=l.button)==null||T.focus()))}),F=E(n=>{n.preventDefault(),n.stopPropagation()}),B=l.popoverState===0,k=a.useMemo(()=>({open:B}),[B]),R=Me(e,P),c=r?{ref:S,type:R,onKeyDown:d,onClick:O}:{ref:w,id:l.buttonId,type:R,"aria-expanded":l.popoverState===0,"aria-controls":l.panel?l.panelId:void 0,onKeyDown:d,onKeyUp:M,onClick:O,onMouseDown:F},I=ce(),f=E(()=>{let n=l.panel;if(!n)return;function p(){A(I.current,{[D.Forwards]:()=>L(n,_.First),[D.Backwards]:()=>L(n,_.Last)})===ne.Error&&L(oe().filter(T=>T.dataset.headlessuiFocusGuard!=="true"),A(I.current,{[D.Forwards]:_.Next,[D.Backwards]:_.Previous}),{relativeTo:l.button})}p()});return h.createElement(h.Fragment,null,j({ourProps:c,theirProps:x,slot:k,defaultTag:Re,name:"Popover.Button"}),B&&!r&&m&&h.createElement(ee,{id:b,features:te.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:f}))}let _e="div",Ge=Q.RenderStrategy|Q.Static;function Le(e,o){let v=q(),{id:g=`headlessui-popover-overlay-${v}`,...x}=e,[{popoverState:l},t]=X("Popover.Overlay"),m=K(o),P=pe(),b=P!==null?(P&U.Open)===U.Open:l===0,i=E(r=>{if(de(r.currentTarget))return r.preventDefault();t({type:1})}),$=a.useMemo(()=>({open:l===0}),[l]);return j({ourProps:{ref:m,id:g,"aria-hidden":!0,onClick:i},theirProps:x,slot:$,defaultTag:_e,features:Ge,visible:b,name:"Popover.Overlay"})}let Ae="div",qe=Q.RenderStrategy|Q.Static;function Ke(e,o){let v=q(),{id:g=`headlessui-popover-panel-${v}`,focus:x=!1,...l}=e,[t,m]=X("Popover.Panel"),{close:P,isPortalled:b}=ue("Popover.Panel"),i=`headlessui-focus-sentinel-before-${q()}`,$=`headlessui-focus-sentinel-after-${q()}`,r=a.useRef(null),N=K(r,o,c=>{m({type:4,panel:c})}),w=re(r),S=ye();Ee(()=>(m({type:5,panelId:g}),()=>{m({type:5,panelId:null})}),[g,m]);let s=pe(),d=s!==null?(s&U.Open)===U.Open:t.popoverState===0,M=E(c=>{var I;switch(c.key){case G.Escape:if(t.popoverState!==0||!r.current||w!=null&&w.activeElement&&!r.current.contains(w.activeElement))return;c.preventDefault(),c.stopPropagation(),m({type:1}),(I=t.button)==null||I.focus();break}});a.useEffect(()=>{var c;e.static||t.popoverState===1&&((c=e.unmount)==null||c)&&m({type:4,panel:null})},[t.popoverState,e.unmount,e.static,m]),a.useEffect(()=>{if(t.__demoMode||!x||t.popoverState!==0||!r.current)return;let c=w==null?void 0:w.activeElement;r.current.contains(c)||L(r.current,_.First)},[t.__demoMode,x,r,t.popoverState]);let O=a.useMemo(()=>({open:t.popoverState===0,close:P}),[t,P]),F={ref:N,id:g,onKeyDown:M,onBlur:x&&t.popoverState===0?c=>{var I,f,n,p,T;let y=c.relatedTarget;y&&r.current&&((I=r.current)!=null&&I.contains(y)||(m({type:1}),((n=(f=t.beforePanelSentinel.current)==null?void 0:f.contains)!=null&&n.call(f,y)||(T=(p=t.afterPanelSentinel.current)==null?void 0:p.contains)!=null&&T.call(p,y))&&y.focus({preventScroll:!0})))}:void 0,tabIndex:-1},B=ce(),k=E(()=>{let c=r.current;if(!c)return;function I(){A(B.current,{[D.Forwards]:()=>{var f;L(c,_.First)===ne.Error&&((f=t.afterPanelSentinel.current)==null||f.focus())},[D.Backwards]:()=>{var f;(f=t.button)==null||f.focus({preventScroll:!0})}})}I()}),R=E(()=>{let c=r.current;if(!c)return;function I(){A(B.current,{[D.Forwards]:()=>{var f;if(!t.button)return;let n=oe(),p=n.indexOf(t.button),T=n.slice(0,p+1),y=[...n.slice(p+1),...T];for(let z of y.slice())if(z.dataset.headlessuiFocusGuard==="true"||(f=t.panel)!=null&&f.contains(z)){let u=y.indexOf(z);u!==-1&&y.splice(u,1)}L(y,_.First,{sorted:!1})},[D.Backwards]:()=>{var f;L(c,_.Previous)===ne.Error&&((f=t.button)==null||f.focus())}})}I()});return h.createElement(Z.Provider,{value:g},d&&b&&h.createElement(ee,{id:i,ref:t.beforePanelSentinel,features:te.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:k}),j({mergeRefs:S,ourProps:F,theirProps:l,slot:O,defaultTag:Ae,features:qe,visible:d,name:"Popover.Panel"}),d&&b&&h.createElement(ee,{id:$,ref:t.afterPanelSentinel,features:te.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:R}))}let Ue="div";function ze(e,o){let v=a.useRef(null),g=K(v,o),[x,l]=a.useState([]),t=me(),m=E(S=>{l(s=>{let d=s.indexOf(S);if(d!==-1){let M=s.slice();return M.splice(d,1),M}return s})}),P=E(S=>(l(s=>[...s,S]),()=>m(S))),b=E(()=>{var S;let s=ge(v);if(!s)return!1;let d=s.activeElement;return(S=v.current)!=null&&S.contains(d)?!0:x.some(M=>{var O,F;return((O=s.getElementById(M.buttonId.current))==null?void 0:O.contains(d))||((F=s.getElementById(M.panelId.current))==null?void 0:F.contains(d))})}),i=E(S=>{for(let s of x)s.buttonId.current!==S&&s.close()}),$=a.useMemo(()=>({registerPopover:P,unregisterPopover:m,isFocusWithinPopoverGroup:b,closeOthers:i,mainTreeNodeRef:t.mainTreeNodeRef}),[P,m,b,i,t.mainTreeNodeRef]),r=a.useMemo(()=>({}),[]),N=e,w={ref:g};return h.createElement(se.Provider,{value:$},j({ourProps:w,theirProps:N,slot:r,defaultTag:Ue,name:"Popover.Group"}),h.createElement(t.MainTreeNode,null))}let He=W(Ne),We=W(De),je=W(Le),Ve=W(Ke),Ye=W(ze),et=Object.assign(He,{Button:We,Overlay:je,Panel:Ve,Group:Ye});export{et as C};
