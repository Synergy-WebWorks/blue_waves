import{r as a,k as T}from"./app-B5Lb9pn2.js";import{y as me,n as pe,u as ee,a as te,s as R,e as Pe,N as be,E as Se}from"./use-root-containers-WZt2nPQ5.js";import{U as W,y as K,o as E,C as j,I as q,n as re,q as ye,l as Ee,e as ce,f as U,O as L,M as _,i as G,r as de,u as A,N as ne,w as oe,h as Q,x as $e,T as ge,s as ie,g as Ie,z as he,A as Te,k as xe}from"./keyboard-CklnEMWW.js";import{T as Me}from"./use-resolve-button-type-CKAhxWlA.js";var we=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(we||{}),Ce=(e=>(e[e.TogglePopover=0]="TogglePopover",e[e.ClosePopover=1]="ClosePopover",e[e.SetButton=2]="SetButton",e[e.SetButtonId=3]="SetButtonId",e[e.SetPanel=4]="SetPanel",e[e.SetPanelId=5]="SetPanelId",e))(Ce||{});let ke={0:e=>{let o={...e,popoverState:A(e.popoverState,{0:1,1:0})};return o.popoverState===0&&(o.__demoMode=!1),o},1(e){return e.popoverState===1?e:{...e,popoverState:1}},2(e,o){return e.button===o.button?e:{...e,button:o.button}},3(e,o){return e.buttonId===o.buttonId?e:{...e,buttonId:o.buttonId}},4(e,o){return e.panel===o.panel?e:{...e,panel:o.panel}},5(e,o){return e.panelId===o.panelId?e:{...e,panelId:o.panelId}}},le=a.createContext(null);le.displayName="PopoverContext";function X(e){let o=a.useContext(le);if(o===null){let v=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(v,X),v}return o}let ae=a.createContext(null);ae.displayName="PopoverAPIContext";function ue(e){let o=a.useContext(ae);if(o===null){let v=new Error(`<${e} /> is missing a parent <Popover /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(v,ue),v}return o}let se=a.createContext(null);se.displayName="PopoverGroupContext";function fe(){return a.useContext(se)}let Z=a.createContext(null);Z.displayName="PopoverPanelContext";function Oe(){return a.useContext(Z)}function Fe(e,o){return A(o.type,ke,e,o)}let Be="div";function Ne(e,o){var v;let{__demoMode:$=!1,...x}=e,l=a.useRef(null),t=K(o,ge(u=>{l.current=u})),m=a.useRef([]),P=a.useReducer(Fe,{__demoMode:$,popoverState:$?0:1,buttons:m,button:null,buttonId:null,panel:null,panelId:null,beforePanelSentinel:a.createRef(),afterPanelSentinel:a.createRef()}),[{popoverState:b,button:i,buttonId:g,panel:r,panelId:N,beforePanelSentinel:w,afterPanelSentinel:S},s]=P,d=re((v=l.current)!=null?v:i),M=a.useMemo(()=>{if(!i||!r)return!1;for(let J of document.querySelectorAll("body > *"))if(Number(J==null?void 0:J.contains(i))^Number(J==null?void 0:J.contains(r)))return!0;let u=oe(),C=u.indexOf(i),V=(C+u.length-1)%u.length,H=(C+1)%u.length,Y=u[V],ve=u[H];return!r.contains(Y)&&!r.contains(ve)},[i,r]),k=ie(g),F=ie(N),B=a.useMemo(()=>({buttonId:k,panelId:F,close:()=>s({type:1})}),[k,F,s]),O=fe(),D=O==null?void 0:O.registerPopover,p=E(()=>{var u;return(u=O==null?void 0:O.isFocusWithinPopoverGroup())!=null?u:(d==null?void 0:d.activeElement)&&((i==null?void 0:i.contains(d.activeElement))||(r==null?void 0:r.contains(d.activeElement)))});a.useEffect(()=>D==null?void 0:D(B),[D,B]);let[I,f]=Pe(),n=be({mainTreeNodeRef:O==null?void 0:O.mainTreeNodeRef,portals:I,defaultContainers:[i,r]});Se(d==null?void 0:d.defaultView,"focus",u=>{var C,V,H,Y;u.target!==window&&u.target instanceof HTMLElement&&b===0&&(p()||i&&r&&(n.contains(u.target)||(V=(C=w.current)==null?void 0:C.contains)!=null&&V.call(C,u.target)||(Y=(H=S.current)==null?void 0:H.contains)!=null&&Y.call(H,u.target)||s({type:1})))},!0),Ie(n.resolveContainers,(u,C)=>{s({type:1}),he(C,Te.Loose)||(u.preventDefault(),i==null||i.focus())},b===0);let c=E(u=>{s({type:1});let C=u?u instanceof HTMLElement?u:"current"in u&&u.current instanceof HTMLElement?u.current:i:i;C==null||C.focus()}),h=a.useMemo(()=>({close:c,isPortalled:M}),[c,M]),y=a.useMemo(()=>({open:b===0,close:c}),[b,c]),z={ref:t};return T.createElement(Z.Provider,{value:null},T.createElement(le.Provider,{value:P},T.createElement(ae.Provider,{value:h},T.createElement(xe,{value:A(b,{0:U.Open,1:U.Closed})},T.createElement(f,null,j({ourProps:z,theirProps:x,slot:y,defaultTag:Be,name:"Popover"}),T.createElement(n.MainTreeNode,null))))))}let De="button";function Re(e,o){let v=q(),{id:$=`headlessui-popover-button-${v}`,...x}=e,[l,t]=X("Popover.Button"),{isPortalled:m}=ue("Popover.Button"),P=a.useRef(null),b=`headlessui-focus-sentinel-${q()}`,i=fe(),g=i==null?void 0:i.closeOthers,r=Oe()!==null;a.useEffect(()=>{if(!r)return t({type:3,buttonId:$}),()=>{t({type:3,buttonId:null})}},[r,$,t]);let[N]=a.useState(()=>Symbol()),w=K(P,o,r?null:n=>{if(n)l.buttons.current.push(N);else{let c=l.buttons.current.indexOf(N);c!==-1&&l.buttons.current.splice(c,1)}l.buttons.current.length>1&&console.warn("You are already using a <Popover.Button /> but only 1 <Popover.Button /> is supported."),n&&t({type:2,button:n})}),S=K(P,o),s=re(P),d=E(n=>{var c,h,y;if(r){if(l.popoverState===1)return;switch(n.key){case G.Space:case G.Enter:n.preventDefault(),(h=(c=n.target).click)==null||h.call(c),t({type:1}),(y=l.button)==null||y.focus();break}}else switch(n.key){case G.Space:case G.Enter:n.preventDefault(),n.stopPropagation(),l.popoverState===1&&(g==null||g(l.buttonId)),t({type:0});break;case G.Escape:if(l.popoverState!==0)return g==null?void 0:g(l.buttonId);if(!P.current||s!=null&&s.activeElement&&!P.current.contains(s.activeElement))return;n.preventDefault(),n.stopPropagation(),t({type:1});break}}),M=E(n=>{r||n.key===G.Space&&n.preventDefault()}),k=E(n=>{var c,h;de(n.currentTarget)||e.disabled||(r?(t({type:1}),(c=l.button)==null||c.focus()):(n.preventDefault(),n.stopPropagation(),l.popoverState===1&&(g==null||g(l.buttonId)),t({type:0}),(h=l.button)==null||h.focus()))}),F=E(n=>{n.preventDefault(),n.stopPropagation()}),B=l.popoverState===0,O=a.useMemo(()=>({open:B}),[B]),D=Me(e,P),p=r?{ref:S,type:D,onKeyDown:d,onClick:k}:{ref:w,id:l.buttonId,type:D,"aria-expanded":l.popoverState===0,"aria-controls":l.panel?l.panelId:void 0,onKeyDown:d,onKeyUp:M,onClick:k,onMouseDown:F},I=pe(),f=E(()=>{let n=l.panel;if(!n)return;function c(){A(I.current,{[R.Forwards]:()=>L(n,_.First),[R.Backwards]:()=>L(n,_.Last)})===ne.Error&&L(oe().filter(h=>h.dataset.headlessuiFocusGuard!=="true"),A(I.current,{[R.Forwards]:_.Next,[R.Backwards]:_.Previous}),{relativeTo:l.button})}c()});return T.createElement(T.Fragment,null,j({ourProps:p,theirProps:x,slot:O,defaultTag:De,name:"Popover.Button"}),B&&!r&&m&&T.createElement(ee,{id:b,features:te.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:f}))}let _e="div",Ge=Q.RenderStrategy|Q.Static;function Le(e,o){let v=q(),{id:$=`headlessui-popover-overlay-${v}`,...x}=e,[{popoverState:l},t]=X("Popover.Overlay"),m=K(o),P=ce(),b=P!==null?(P&U.Open)===U.Open:l===0,i=E(r=>{if(de(r.currentTarget))return r.preventDefault();t({type:1})}),g=a.useMemo(()=>({open:l===0}),[l]);return j({ourProps:{ref:m,id:$,"aria-hidden":!0,onClick:i},theirProps:x,slot:g,defaultTag:_e,features:Ge,visible:b,name:"Popover.Overlay"})}let Ae="div",qe=Q.RenderStrategy|Q.Static;function Ke(e,o){let v=q(),{id:$=`headlessui-popover-panel-${v}`,focus:x=!1,...l}=e,[t,m]=X("Popover.Panel"),{close:P,isPortalled:b}=ue("Popover.Panel"),i=`headlessui-focus-sentinel-before-${q()}`,g=`headlessui-focus-sentinel-after-${q()}`,r=a.useRef(null),N=K(r,o,p=>{m({type:4,panel:p})}),w=re(r),S=ye();Ee(()=>(m({type:5,panelId:$}),()=>{m({type:5,panelId:null})}),[$,m]);let s=ce(),d=s!==null?(s&U.Open)===U.Open:t.popoverState===0,M=E(p=>{var I;switch(p.key){case G.Escape:if(t.popoverState!==0||!r.current||w!=null&&w.activeElement&&!r.current.contains(w.activeElement))return;p.preventDefault(),p.stopPropagation(),m({type:1}),(I=t.button)==null||I.focus();break}});a.useEffect(()=>{var p;e.static||t.popoverState===1&&((p=e.unmount)==null||p)&&m({type:4,panel:null})},[t.popoverState,e.unmount,e.static,m]),a.useEffect(()=>{if(t.__demoMode||!x||t.popoverState!==0||!r.current)return;let p=w==null?void 0:w.activeElement;r.current.contains(p)||L(r.current,_.First)},[t.__demoMode,x,r,t.popoverState]);let k=a.useMemo(()=>({open:t.popoverState===0,close:P}),[t,P]),F={ref:N,id:$,onKeyDown:M,onBlur:x&&t.popoverState===0?p=>{var I,f,n,c,h;let y=p.relatedTarget;y&&r.current&&((I=r.current)!=null&&I.contains(y)||(m({type:1}),((n=(f=t.beforePanelSentinel.current)==null?void 0:f.contains)!=null&&n.call(f,y)||(h=(c=t.afterPanelSentinel.current)==null?void 0:c.contains)!=null&&h.call(c,y))&&y.focus({preventScroll:!0})))}:void 0,tabIndex:-1},B=pe(),O=E(()=>{let p=r.current;if(!p)return;function I(){A(B.current,{[R.Forwards]:()=>{var f;L(p,_.First)===ne.Error&&((f=t.afterPanelSentinel.current)==null||f.focus())},[R.Backwards]:()=>{var f;(f=t.button)==null||f.focus({preventScroll:!0})}})}I()}),D=E(()=>{let p=r.current;if(!p)return;function I(){A(B.current,{[R.Forwards]:()=>{var f;if(!t.button)return;let n=oe(),c=n.indexOf(t.button),h=n.slice(0,c+1),y=[...n.slice(c+1),...h];for(let z of y.slice())if(z.dataset.headlessuiFocusGuard==="true"||(f=t.panel)!=null&&f.contains(z)){let u=y.indexOf(z);u!==-1&&y.splice(u,1)}L(y,_.First,{sorted:!1})},[R.Backwards]:()=>{var f;L(p,_.Previous)===ne.Error&&((f=t.button)==null||f.focus())}})}I()});return T.createElement(Z.Provider,{value:$},d&&b&&T.createElement(ee,{id:i,ref:t.beforePanelSentinel,features:te.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:O}),j({mergeRefs:S,ourProps:F,theirProps:l,slot:k,defaultTag:Ae,features:qe,visible:d,name:"Popover.Panel"}),d&&b&&T.createElement(ee,{id:g,ref:t.afterPanelSentinel,features:te.Focusable,"data-headlessui-focus-guard":!0,as:"button",type:"button",onFocus:D}))}let Ue="div";function ze(e,o){let v=a.useRef(null),$=K(v,o),[x,l]=a.useState([]),t=me(),m=E(S=>{l(s=>{let d=s.indexOf(S);if(d!==-1){let M=s.slice();return M.splice(d,1),M}return s})}),P=E(S=>(l(s=>[...s,S]),()=>m(S))),b=E(()=>{var S;let s=$e(v);if(!s)return!1;let d=s.activeElement;return(S=v.current)!=null&&S.contains(d)?!0:x.some(M=>{var k,F;return((k=s.getElementById(M.buttonId.current))==null?void 0:k.contains(d))||((F=s.getElementById(M.panelId.current))==null?void 0:F.contains(d))})}),i=E(S=>{for(let s of x)s.buttonId.current!==S&&s.close()}),g=a.useMemo(()=>({registerPopover:P,unregisterPopover:m,isFocusWithinPopoverGroup:b,closeOthers:i,mainTreeNodeRef:t.mainTreeNodeRef}),[P,m,b,i,t.mainTreeNodeRef]),r=a.useMemo(()=>({}),[]),N=e,w={ref:$};return T.createElement(se.Provider,{value:g},j({ourProps:w,theirProps:N,slot:r,defaultTag:Ue,name:"Popover.Group"}),T.createElement(t.MainTreeNode,null))}let He=W(Ne),We=W(Re),je=W(Le),Ve=W(Ke),Ye=W(ze),et=Object.assign(He,{Button:We,Overlay:je,Panel:Ve,Group:Ye});export{et as C};
